var marmottajax=function(e){return marmottajax.get(e)};marmottajax.normalize=function(e){return e?typeof e==="string"?{url:e}:e:false};marmottajax.json=function(e){if(e=marmottajax.normalize(e)){e.json=true;return new marmottajax.request(e)}};marmottajax.get=function(e){return new marmottajax.request(e)};marmottajax.post=function(e){if(e=marmottajax.normalize(e)){e.method="POST";return new marmottajax.request(e)}};marmottajax.put=function(e){if(e=marmottajax.normalize(e)){e.method="PUT";return new marmottajax.request(e)}};marmottajax.delete=function(e){if(e=marmottajax.normalize(e)){e.method="DELETE";return new marmottajax.request(e)}};marmottajax.request=function(e){if(!e){return false}if(typeof e=="string"){e={url:e}}if(e.method==="POST"||e.method==="PUT"||e.method=="DELETE"){var t="?";for(var n in e.options){t+=e.options.hasOwnProperty(n)?"&"+n+"="+e.options[n]:""}}else{e.method="GET";e.url+=e.url.indexOf("?")<0?"?":"";for(var n in e.options){e.url+=e.options.hasOwnProperty(n)?"&"+n+"="+e.options[n]:""}}this.xhr=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");this.xhr.options=e;this.xhr.callbacks={then:[],error:[]};this.then=function(e){this.xhr.callbacks.then.push(e);return this};this.error=function(e){this.xhr.callbacks.error.push(e);return this};this.xhr.call=function(e,t){for(var n=0;n<this.callbacks[e].length;n++){if(typeof this.callbacks[e][n]==="function"){this.callbacks[e][n](t)}}};this.xhr.returnSuccess=function(e){this.call("then",e)};this.xhr.returnError=function(e){this.call("error",e)};this.xhr.onreadystatechange=function(){if(this.readyState===4&&this.status==200){var e=this.responseText;if(this.options.json){try{e=JSON.parse(e)}catch(t){this.returnError("invalid json");return false}}this.returnSuccess(e)}else if(this.readyState===4&&this.status==404){this.returnError("404")}else if(this.readyState===4){this.returnError("unknow")}};this.xhr.open(e.method,e.url,true);this.xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");this.xhr.send(typeof t!="undefined"?t:null)}